<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="palaeoverse">
<title>Latitudinal trends in Phanerozoic reefs • palaeoverse</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Latitudinal trends in Phanerozoic reefs">
<meta property="og:description" content="palaeoverse">
<meta property="og:image" content="https://palaeoverse.palaeoverse.org/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">palaeoverse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/phanerozoic-reefs.html">Latitudinal trends in Phanerozoic reefs</a>
    <a class="dropdown-item" href="../articles/tetrapod-biodiversity.html">Alpha diversity and geographic range size of Carboniferous and Permian tetrapods</a>
    <a class="dropdown-item" href="../articles/structure-and-standards.html">Contributing to palaeoverse: structure and standards</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/palaeoverse/palaeoverse/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Latitudinal trends in Phanerozoic reefs</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/palaeoverse/palaeoverse/blob/HEAD/vignettes/phanerozoic-reefs.Rmd" class="external-link"><code>vignettes/phanerozoic-reefs.Rmd</code></a></small>
      <div class="d-none name"><code>phanerozoic-reefs.Rmd</code></div>
    </div>

    
    
<p><strong>Authors:</strong> <a href="https://palaeoverse.org/#about-us" class="external-link">The Palaeoverse Development
Team</a></p>
<p><strong>Last updated:</strong> 2024-04-16</p>
<div style="text-align: justify">
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code>palaeoverse</code> is an R package developed by
palaeobiologists, for palaeobiologists. The aim of the package is to
generate a community-driven toolkit of generic functions for the
palaeobiological community. The package does not provide implementations
of statistical analyses, rather it provides auxiliary functions to help
streamline analyses and improve code readability and reproducibility.
This vignette (or tutorial if you prefer) is provided to guide you
through the installation process and some of the functionality available
within <code>palaeoverse</code>. To do so, we will focus on a usage
example looking at latitudinal trends in Phanerozoic reefs.</p>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>The <code>palaeoverse</code> package can be installed via CRAN or its
dedicated <a href="https://github.com/palaeoverse/palaeoverse" class="external-link">GitHub
repository</a> if the development version is preferred. To install via
the CRAN, simply use:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"palaeoverse"</span><span class="op">)</span></span></code></pre></div>
<p>To install the development version, first install the
<code>devtools</code> package, and then use <code>install_github</code>
to install <code>palaeoverse</code> directly from GitHub.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"palaeoverse/palaeoverse"</span><span class="op">)</span></span></code></pre></div>
<p>You can now load <code>palaeoverse</code> using the default
<code>library</code> function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://palaeoverse.palaeoverse.org">palaeoverse</a></span><span class="op">)</span></span></code></pre></div>
<p><strong>Before we get onto the good stuff, the development team has a
small request</strong>. If you use <code>palaeoverse</code> in your
research, please cite the associated publication. This will help us to
continue our work in supporting you to do yours. You can access the
appropriate citation via:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"palaeoverse"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="using-the-package">Using the package<a class="anchor" aria-label="anchor" href="#using-the-package"></a>
</h3>
<p>Functions in <code>palaeoverse</code> are designed around the
assumption that most users’ data are stored in an occurrence
<code>data.frame</code>. As such, this is the expected input data format
for most functions. We provide two example occurrence datasets
(<code>tetrapods</code> and <code>reefs</code>) within the package from
different data sources. In this vignette, we will focus on the
<code>reefs</code> dataset which is a compilation of Phanerozoic reef
occurrences (<em>n</em> = 4,363) from the <a href="https://www.paleo-reefs.pal.uni-erlangen.de" class="external-link">PaleoReefs
Database</a> (Kiessling &amp; Krause, 2022).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">reefs</span><span class="op">)</span></span>
<span><span class="co"># View the first five rows &amp; columns of reefs</span></span>
<span><span class="va">reefs</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##   r_number               name             formation   system         series</span></span>
<span><span class="co">## 1        1   Tilkideligi Tepe                       Triassic Upper Triassic</span></span>
<span><span class="co">## 2        2              Hydra Pantokrator Limestone Triassic Upper Triassic</span></span>
<span><span class="co">## 3        3 Shiraho, W-Pacific                        Neogene       Holocene</span></span>
<span><span class="co">## 4        4 Aksu-Terziler area                       Triassic Upper Triassic</span></span>
<span><span class="co">## 5        5    Adnet, Salzburg                       Triassic Upper Triassic</span></span></code></pre>
<p><em>Note the structure of the dataset. Each row contains a unique
occurrence and each column contains a unique variable.</em></p>
</div>
</div>
<div class="section level2">
<h2 id="lets-begin">Let’s begin!<a class="anchor" aria-label="anchor" href="#lets-begin"></a>
</h2>
<p>Reefs have long been considered good tracers of past tropical and
subtropical conditions (Kiessling, 2001; Perrin &amp; Kiessling, 2010).
More specifically, their distribution has historically been used to
infer the latitudinal extent of tropical and subtropical climatic
conditions in deep time. This is of course an oversimplification given
all we know about modern reefs systems and their engineers. However, for
the purpose of this example, let’s not get weighed down by the finer
details.</p>
<p>In this example, we will use the <code>reefs</code> dataset to
examine latitudinal trends in Phanerozoic reefs and demonstrate some of
the functionality available in <code>palaeoverse</code>.</p>
<p>Let’s start by exploring the dataset. Before conducting any analyses,
it is always a good idea to explore your data and understand what you
are working with. Details related to the example datasets can be
accessed via the usual documentation call:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Call documentation for dataset</span></span>
<span><span class="op">?</span><span class="va">reefs</span></span>
<span><span class="co"># You can also use</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">reefs</span><span class="op">)</span></span></code></pre></div>
<p>Let’s start by exploring the data a little:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># How many reefs are there in the dataset?</span></span>
<span><span class="co"># Each row represents an individual reef.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">reefs</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 4363</span></span></code></pre>
<p>Not bad (<em>n</em> = 4363), that’s quite a bit of data to play with!
Remember that these are reefs (whole ecosystems), not individual
occurrences of fossil organisms like in <code>tetrapods</code>. But how
much does this vary across time? We can make use of the
<code>group_apply</code> wrapper function to run a function across
subsets of data.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># How many reefs per interval?</span></span>
<span><span class="co"># Let's group by the interval column to test</span></span>
<span><span class="va">reef_counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/group_apply.html">group_apply</a></span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">reefs</span>, group <span class="op">=</span> <span class="st">"interval"</span>, fun <span class="op">=</span> <span class="va">nrow</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">reef_counts</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   nrow                interval</span></span>
<span><span class="co">## 1    2       (early?) Toarcian</span></span>
<span><span class="co">## 2    1       Aalenian-Bajocian</span></span>
<span><span class="co">## 3    4       Aalenian/Bajocian</span></span>
<span><span class="co">## 4    1 Aalenian/lower Bajocian</span></span>
<span><span class="co">## 5    1               Abadehian</span></span>
<span><span class="co">## 6    6                Aeronian</span></span></code></pre>
<p>Oh dear, we’ve just hit a common issue… our reef data does not
conform to a common time scale! Some reefs are resolved to stage level,
while others are resolved to a coarser or finer temporal resolution. In
some instances, regional names are also used, while international names
are used in others. This makes it challenging to make comparisons
through time… one solution could be to use age values to bin the reefs
into time bins, but no age range data is provided in the dataset
(i.e. “max_ma” and “min_ma”). We must therefore use the names of each
interval to link to a common time scale, the ‘<a href="https://stratigraphy.org/chart" class="external-link">International Geological
Stages</a>’ established by the International Commission on Stratigraphy
(ICS). Fortunately, we can make use of the <code>look_up</code> function
to do so. This function can be used to assign international geological
stages and numeric ages to occurrences, or use a user-defined interval
key to link to a common time scale. Here, we will use the example
<code>interval_key</code> available in <code>palaeoverse</code> to
assign international geological stage names and numeric ages.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the interval key</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"interval_key"</span><span class="op">)</span></span>
<span><span class="co"># Assign a common time scale based on an interval key</span></span>
<span><span class="va">reefs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/look_up.html">look_up</a></span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">reefs</span>,</span>
<span>                 early_interval <span class="op">=</span> <span class="st">"interval"</span>,</span>
<span>                 late_interval <span class="op">=</span> <span class="st">"interval"</span>,</span>
<span>                 int_key <span class="op">=</span> <span class="va">interval_key</span><span class="op">)</span></span>
<span><span class="co"># Example output</span></span>
<span><span class="va">reefs</span><span class="op">[</span><span class="fl">100</span><span class="op">:</span><span class="fl">110</span>, <span class="fl">15</span><span class="op">:</span><span class="fl">19</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##     early_stage late_stage interval_max_ma interval_mid_ma interval_min_ma</span></span>
<span><span class="co">## 100    Ladinian    Carnian           242.0          234.50           227.0</span></span>
<span><span class="co">## 101      Norian     Norian           227.0          217.75           208.5</span></span>
<span><span class="co">## 102    Rhaetian   Rhaetian           208.5          204.90           201.3</span></span>
<span><span class="co">## 103    Ladinian    Carnian           242.0          234.50           227.0</span></span>
<span><span class="co">## 104      Norian   Rhaetian           227.0          214.15           201.3</span></span>
<span><span class="co">## 105     Anisian    Anisian           247.2          244.60           242.0</span></span>
<span><span class="co">## 106    Rhaetian   Rhaetian           208.5          204.90           201.3</span></span>
<span><span class="co">## 107  Sinemurian Sinemurian           199.3          195.05           190.8</span></span>
<span><span class="co">## 108   Oxfordian  Oxfordian           163.5          160.40           157.3</span></span>
<span><span class="co">## 109   Tithonian  Tithonian           152.1          148.55           145.0</span></span>
<span><span class="co">## 110   Tithonian  Tithonian           152.1          148.55           145.0</span></span></code></pre>
<p>Great! We now have a common time scale and numeric ages. However,
some of our reefs seem to range through several stages and we can’t
count just by the early or late stage. Our data still need to be binned.
Let’s check out the <code>time_bins</code> and <code>bin_time</code>
functions.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Now we have numeric ages for our data, we can easily</span></span>
<span><span class="co"># remove pre-Phanerozoic data to focus our study</span></span>
<span><span class="va">reefs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">reefs</span>, <span class="va">interval_max_ma</span> <span class="op">&lt;=</span> <span class="fl">541</span><span class="op">)</span></span>
<span><span class="co"># Extract Phanerozoic stage-level stages for time bins</span></span>
<span><span class="va">bins</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/time_bins.html">time_bins</a></span><span class="op">(</span>interval <span class="op">=</span> <span class="st">"Phanerozoic"</span>, rank <span class="op">=</span> <span class="st">"stage"</span><span class="op">)</span></span>
<span><span class="co"># Bin data</span></span>
<span><span class="co"># bin_time requires "max_ma" and "min_ma" columns</span></span>
<span><span class="co"># Rename columns in reefs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">reefs</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">reefs</span><span class="op">)</span> <span class="op">==</span> <span class="st">"interval_max_ma"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"max_ma"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">reefs</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">reefs</span><span class="op">)</span> <span class="op">==</span> <span class="st">"interval_min_ma"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"min_ma"</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Five methods exist in bin_time for binning occurrence data</span></span>
<span><span class="co"># You can see details on each via ?bin_time</span></span>
<span><span class="co"># Bin by midpoint age</span></span>
<span><span class="fu"><a href="../reference/bin_time.html">bin_time</a></span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">reefs</span>, bins <span class="op">=</span> <span class="va">bins</span>, method <span class="op">=</span> <span class="st">"mid"</span><span class="op">)</span></span>
<span><span class="co"># Bin by overlap majority</span></span>
<span><span class="fu"><a href="../reference/bin_time.html">bin_time</a></span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">reefs</span>, bins <span class="op">=</span> <span class="va">bins</span>, method <span class="op">=</span> <span class="st">"majority"</span><span class="op">)</span></span>
<span><span class="co"># Bin into every bin within age range</span></span>
<span><span class="fu"><a href="../reference/bin_time.html">bin_time</a></span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">reefs</span>, bins <span class="op">=</span> <span class="va">bins</span>, method <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span>
<span><span class="co"># Bin randomly into bins within age range (equal probability)</span></span>
<span><span class="fu"><a href="../reference/bin_time.html">bin_time</a></span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">reefs</span>, bins <span class="op">=</span> <span class="va">bins</span>, method <span class="op">=</span> <span class="st">"random"</span>, reps <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co"># Bin randomly into bins within age range (uniform probability)</span></span>
<span><span class="fu"><a href="../reference/bin_time.html">bin_time</a></span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">reefs</span>, bins <span class="op">=</span> <span class="va">bins</span>, method <span class="op">=</span> <span class="st">"point"</span>, reps <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Let's go with "all" for this example!</span></span>
<span><span class="va">reefs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bin_time.html">bin_time</a></span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">reefs</span>, bins <span class="op">=</span> <span class="va">bins</span>, method <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></code></pre></div>
<p>Note that the number of rows of <code>reefs</code> have now
increased. This is because the “all” method in <code>bin_time</code>
duplicates an occurrence for every bin the age range overlaps with.</p>
<p>Let’s check those reef numbers through time again using our binned
data:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Count number of occurrences per interval</span></span>
<span><span class="va">reefs_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/group_apply.html">group_apply</a></span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">reefs</span>, group <span class="op">=</span> <span class="st">"interval_mid_ma"</span>, fun <span class="op">=</span> <span class="va">nrow</span><span class="op">)</span></span>
<span><span class="co"># Check output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">reefs_time</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   nrow interval_mid_ma</span></span>
<span><span class="co">## 1    9         0.00585</span></span>
<span><span class="co">## 2   85         0.07035</span></span>
<span><span class="co">## 3   10         0.39285</span></span>
<span><span class="co">## 4   17          0.4515</span></span>
<span><span class="co">## 5   68         1.29585</span></span>
<span><span class="co">## 6    9          1.3545</span></span></code></pre>
<p>That’s more like it! But, let’s not forget it’s always useful to
visualise our data. Why don’t we plot the number of reefs through time?
We can even make use of the <code>axis_geo</code> function to add the
Geological Time Scale to our plot.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">reefs_time</span><span class="op">$</span><span class="va">interval_mid_ma</span>,</span>
<span>     y <span class="op">=</span> <span class="va">reefs_time</span><span class="op">$</span><span class="va">nrow</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Time (Ma)"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Number of reefs per stage"</span>,</span>
<span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">541</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>     xaxt <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="co"># Add axis of the geological time scale</span></span>
<span><span class="fu"><a href="../reference/axis_geo.html">axis_geo</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">1</span>, intervals <span class="op">=</span> <span class="st">"periods"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="n-reef-1.png" alt="plot of chunk n-reef" width="100%"><p class="caption">
plot of chunk n-reef
</p>
</div>
<p>You would (and should) of course want to explore your data a little
more than this. However, for the sake of brevity, let’s focus on our
research theme: latitudinal trends in Phanerozoic reefs.</p>
<p>When studying modern latitudinal trends (e.g. in biodiversity),
researchers can use the geographic coordinates of their samples to
conduct analyses. However, as the continents shift through time,
palaeobiologists must reconstruct the palaeogeographic coordinates of
fossil localities. To do so, plate rotation models are used (e.g. the
PALEOMAP model) to rotate the modern coordinates of fossil localities to
their location at time of deposition. The <code>palaeorotate</code>
function allows the user to do so using either the ‘point’ or ‘grid’
method. The first approach makes use of the GPlates Web Service and
allows point data to be rotated to specific ages using the available
models (see the <a href="https://gwsdoc.gplates.org" class="external-link">GPlates Web Service
documentation</a>). The second approach uses reconstruction files of
pre-generated palaeocoordinates to spatiotemporally link occurrences’
modern coordinates and age estimates with their respective
palaeocoordinates. Let’s give it a shot:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Palaeorotate occurrences</span></span>
<span><span class="va">reefs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/palaeorotate.html">palaeorotate</a></span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">reefs</span>, age <span class="op">=</span> <span class="st">"bin_midpoint"</span>,</span>
<span>                      method <span class="op">=</span> <span class="st">"point"</span>, model <span class="op">=</span> <span class="st">"PALEOMAP"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check palaeocoordinates</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">reefs</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p_lng"</span>, <span class="st">"p_lat"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     p_lng   p_lat</span></span>
<span><span class="co">## 1 21.3630 10.0755</span></span>
<span><span class="co">## 2 22.1341  2.3106</span></span>
<span><span class="co">## 3      NA      NA</span></span>
<span><span class="co">## 4      NA      NA</span></span>
<span><span class="co">## 5      NA      NA</span></span>
<span><span class="co">## 6 26.3041 -0.3093</span></span></code></pre>
<p>Now let’s plot that palaeolatitudinal distribution!</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">reefs</span><span class="op">$</span><span class="va">bin_midpoint</span>,</span>
<span>     y <span class="op">=</span> <span class="va">reefs</span><span class="op">$</span><span class="va">p_lat</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Time (Ma)"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Palaeolatitude (\u00B0)"</span>,</span>
<span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">541</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>     xaxt <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"p"</span>, pch <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/axis_geo.html">axis_geo</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">1</span>, intervals <span class="op">=</span> <span class="st">"periods"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reefs-dist-1.png" alt="plot of chunk reefs-dist" width="100%"><p class="caption">
plot of chunk reefs-dist
</p>
</div>
<p>Neat! But it’s hard to draw any trends from this data (there is a lot
of it!). We can do better… let’s summarise this information… if we
assume that reefs are broadly limited to tropical and subtropical
climatic conditions, the most poleward reef in each time bin should give
us an estimate of the palaeolatitudinal extent of these climatic
conditions.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Let's first assume hemispheric symmetry and convert</span></span>
<span><span class="co"># palaeolatitudes to absolute palaeolatitudes</span></span>
<span><span class="va">reefs</span><span class="op">$</span><span class="va">p_lat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">reefs</span><span class="op">$</span><span class="va">p_lat</span><span class="op">)</span></span>
<span><span class="co"># Now we can calculate the most poleward latitude per time bin</span></span>
<span><span class="co"># Extract unique interval midpoints</span></span>
<span><span class="va">midpoints</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">reefs</span><span class="op">$</span><span class="va">bin_midpoint</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Calculate the maximum palaeolatitude for each time bin</span></span>
<span><span class="va">reefs_max</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">midpoints</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">reefs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">reefs</span><span class="op">$</span><span class="va">bin_midpoint</span> <span class="op">==</span> <span class="va">x</span><span class="op">)</span>, <span class="op">]</span><span class="op">$</span><span class="va">p_lat</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="op">)</span></span>
<span><span class="co"># Plot data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">midpoints</span>,</span>
<span>     y <span class="op">=</span> <span class="va">reefs_max</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Time (Ma)"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Palaeolatitude (\u00B0)"</span>,</span>
<span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">541</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>     xaxt <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"b"</span>,</span>
<span>     pch <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="co"># Add axis of the geological time scale</span></span>
<span><span class="fu"><a href="../reference/axis_geo.html">axis_geo</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">1</span>, intervals <span class="op">=</span> <span class="st">"periods"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reefs-max-1.png" alt="plot of chunk reefs-max" width="100%"><p class="caption">
plot of chunk reefs-max
</p>
</div>
<p>That’s definitely much clearer! Should we stop there? Well… how about
one last thing… let’s consider how plate rotation model choice might
impact these results using three different models: GOLONKA, PALEOMAP,
and MERDITH2021 (Wright et al. 2013; Scotese &amp; Wright, 2018; Merdith
et al. 2021).</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We can call multiple models at once with palaeorotate</span></span>
<span><span class="co"># First, let's define the models...</span></span>
<span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GOLONKA"</span>, <span class="st">"PALEOMAP"</span>, <span class="st">"MERDITH2021"</span><span class="op">)</span></span>
<span><span class="co"># And now palaeorotate!</span></span>
<span><span class="va">reefs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/palaeorotate.html">palaeorotate</a></span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">reefs</span>, age <span class="op">=</span> <span class="st">"bin_midpoint"</span>,</span>
<span>                      method <span class="op">=</span> <span class="st">"point"</span>, model <span class="op">=</span> <span class="va">models</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check palaeocoordinates</span></span>
<span><span class="co"># When multiple models are called, the name of the model</span></span>
<span><span class="co"># is added as a suffix to p_lng and p_lat</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">reefs</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p_lng_PALEOMAP"</span>, <span class="st">"p_lat_PALEOMAP"</span>,</span>
<span>               <span class="st">"p_lng_GOLONKA"</span>, <span class="st">"p_lat_GOLONKA"</span>,</span>
<span>               <span class="st">"p_lng_MERDITH2021"</span>, <span class="st">"p_lat_MERDITH2021"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   p_lng_PALEOMAP p_lat_PALEOMAP p_lng_GOLONKA p_lat_GOLONKA p_lng_MERDITH2021</span></span>
<span><span class="co">## 1        21.3630        10.0755       35.6565        8.3384           34.4223</span></span>
<span><span class="co">## 2        22.1341         2.3106       31.0982        4.8069           30.8863</span></span>
<span><span class="co">## 3             NA             NA      124.2500       24.3330          124.2489</span></span>
<span><span class="co">## 4             NA             NA      124.2500       24.3330          124.2493</span></span>
<span><span class="co">## 5             NA             NA      124.2500       24.3330          124.2498</span></span>
<span><span class="co">## 6        26.3041        -0.3093       38.0979        4.9270           36.3998</span></span>
<span><span class="co">##   p_lat_MERDITH2021</span></span>
<span><span class="co">## 1           12.1964</span></span>
<span><span class="co">## 2            4.7404</span></span>
<span><span class="co">## 3           24.3367</span></span>
<span><span class="co">## 4           24.3352</span></span>
<span><span class="co">## 5           24.3337</span></span>
<span><span class="co">## 6            4.5809</span></span></code></pre>
<p>Now we’ve palaeorotated our data, let’s repeat what we did earlier
and calculate the most poleward reef occurrence for each model.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Let's code a little helper function to begin with.</span></span>
<span><span class="co"># This is generally useful when repeating code several times!</span></span>
<span><span class="va">p_lat_max</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">occdf</span>, <span class="va">midpoint</span>, <span class="va">p_lat</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Get absolute palaeolatitudes</span></span>
<span>  <span class="va">occdf</span><span class="op">[</span>, <span class="va">p_lat</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">occdf</span><span class="op">[</span>, <span class="va">p_lat</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="co"># Extract unique bin midpoints</span></span>
<span>  <span class="va">midpoints</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">occdf</span><span class="op">[</span>, <span class="va">midpoint</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co"># Calculate maximum palaeolatitude for each bin</span></span>
<span>  <span class="va">lat_max</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">midpoints</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">occdf</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">occdf</span><span class="op">[</span>, <span class="va">midpoint</span><span class="op">]</span> <span class="op">==</span> <span class="va">x</span><span class="op">)</span>, <span class="op">]</span><span class="op">[</span>, <span class="va">p_lat</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="co"># Bind data</span></span>
<span>  <span class="va">lat_max</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind.data.frame</a></span><span class="op">(</span><span class="va">midpoints</span>, <span class="va">lat_max</span><span class="op">)</span></span>
<span>  <span class="co"># Return df</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">lat_max</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># Calculate maximum palaeolatitude of reefs for each time bin for each model</span></span>
<span><span class="va">paleomap</span> <span class="op">&lt;-</span> <span class="fu">p_lat_max</span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">reefs</span>,</span>
<span>                      midpoint <span class="op">=</span> <span class="st">"bin_midpoint"</span>,</span>
<span>                      p_lat <span class="op">=</span> <span class="st">"p_lat_PALEOMAP"</span><span class="op">)</span></span>
<span><span class="va">golonka</span> <span class="op">&lt;-</span> <span class="fu">p_lat_max</span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">reefs</span>,</span>
<span>                     midpoint <span class="op">=</span> <span class="st">"bin_midpoint"</span>,</span>
<span>                     p_lat <span class="op">=</span> <span class="st">"p_lat_GOLONKA"</span><span class="op">)</span></span>
<span><span class="va">merdith</span> <span class="op">&lt;-</span> <span class="fu">p_lat_max</span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">reefs</span>,</span>
<span>                     midpoint <span class="op">=</span> <span class="st">"bin_midpoint"</span>,</span>
<span>                     p_lat <span class="op">=</span> <span class="st">"p_lat_MERDITH2021"</span><span class="op">)</span></span>
<span><span class="co"># Set up plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>     y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Time (Ma)"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Palaeolatitude (\u00B0)"</span>,</span>
<span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">541</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">90</span><span class="op">)</span>,</span>
<span>     xaxt <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span><span class="co"># Plot maximum palaeolatitudes for each model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">paleomap</span><span class="op">$</span><span class="va">midpoints</span>, y <span class="op">=</span> <span class="va">paleomap</span><span class="op">$</span><span class="va">lat_max</span>,</span>
<span>      type <span class="op">=</span> <span class="st">"o"</span>, col <span class="op">=</span> <span class="st">"#e41a1c"</span>, pch <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">golonka</span><span class="op">$</span><span class="va">midpoints</span>, y <span class="op">=</span> <span class="va">golonka</span><span class="op">$</span><span class="va">lat_max</span>,</span>
<span>      type <span class="op">=</span> <span class="st">"o"</span>, col <span class="op">=</span> <span class="st">"#377eb8"</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">merdith</span><span class="op">$</span><span class="va">midpoints</span>, y <span class="op">=</span> <span class="va">merdith</span><span class="op">$</span><span class="va">lat_max</span>,</span>
<span>      type <span class="op">=</span> <span class="st">"o"</span>, col <span class="op">=</span> <span class="st">"#4daf4a"</span>, pch <span class="op">=</span> <span class="fl">17</span><span class="op">)</span></span>
<span><span class="co"># Add legend</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="fl">530</span>, <span class="fl">15</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PALEOMAP"</span>, <span class="st">"GOLONKA"</span>, <span class="st">"MERDITH2021"</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#e41a1c"</span>, <span class="st">"#377eb8"</span>, <span class="st">"#4daf4a"</span><span class="op">)</span>,</span>
<span>       lty <span class="op">=</span> <span class="fl">1</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">17</span><span class="op">)</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span><span class="co"># Add geological time scale axis</span></span>
<span><span class="fu"><a href="../reference/axis_geo.html">axis_geo</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">1</span>, intervals <span class="op">=</span> <span class="st">"periods"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reefs-max-multi-1.png" alt="plot of chunk reefs-max-multi" width="100%"><p class="caption">
plot of chunk reefs-max-multi
</p>
</div>
<p>We will leave you to make your own conclusions…</p>
<p>Hopefully this vignette has shown you the potential uses for
<code>palaeoverse</code> functions and helped provide a workflow for
your own analyses. If you have any questions about the package or its
functionality, please feel free to join our <a href="https://groups.google.com/g/palaeoverse" class="external-link">Palaeoverse Google
group</a> and leave a question; we’ll aim to answer it as soon as
possible!</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Kiessling, W. (2001). Paleoclimatic significance of Phanerozoic
reefs. Geology 29, 751–754.</p>
<p>Perrin, C. &amp; Kiessling, W. (2010) Latitudinal trends in Cenozoic
reef patterns and their relationship to climate. Carbonate Syst.
Oligocene–Miocene Clim. Transit. 17–33.</p>
<p>Kiessling, W. &amp; Krause, M. C. (2022). PaleoReefs Database (PARED)
(1.0) Data set. DOI: 10.5281/zenodo.6037852.</p>
<p>Merdith, A., Williams, S.E., Collins, A.S., Tetley, M.G., Mulder,
J.A., Blades, M.L., Young, A., Armistead, S.E., Cannon, J., Zahirovic,
S., Müller. R.D. (2021). Extending full-plate tectonic models into deep
time: Linking the Neoproterozoic and the Phanerozoic. Earth-Science
Reviews, 214(103477). DOI: 10.1016/j.earscirev.2020.103477.</p>
<p>Scotese, C., &amp; Wright, N. M. (2018). PALEOMAP Paleodigital
Elevation Models (PaleoDEMs) for the Phanerozoic. <a href="https://www.earthbyte.org/paleodem-resource-scotese-and-wright-2018/" class="external-link">PALEOMAP
Project</a>.</p>
<p>Wright, N., Zahirovic, S., Müller, R. D., &amp; Seton, M. (2013).
Towards community-driven paleogeographic reconstructions: integrating
open-access paleogeographic and paleobiology data with plate tectonics.
Biogeosciences, 10(3), 1529-1541. DOI: 10.5194/bg-10-1529-2013.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.lewisajones.com" class="external-link">Lewis A. Jones</a>, <a href="https://williamgearty.com" class="external-link">William Gearty</a>, <a href="https://bsse.ethz.ch/cevo/the-group/people/person-detail.html?persid=295484" class="external-link">Bethany J. Allen</a>, <a href="https://keichenseer.netlify.app" class="external-link">Kilian Eichenseer</a>, <a href="https://www.ucl.ac.uk/earth-sciences/people/research-staff/dr-chris-dean" class="external-link">Christopher D. Dean</a>, <a href="https://www.researchgate.net/profile/Joseph-Flannery-Sutherland" class="external-link">Joseph T. Flannery-Sutherland</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
