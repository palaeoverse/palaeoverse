<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate the geographic range of fossil taxa — tax_range_space • palaeoverse</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate the geographic range of fossil taxa — tax_range_space"><meta name="description" content="A function to calculate the geographic range of fossil taxa from occurrence
data. The function can calculate geographic range in four ways: convex
hull, latitudinal range, maximum Great Circle Distance, and the number of
occupied equal-area hexagonal grid cells."><meta property="og:description" content="A function to calculate the geographic range of fossil taxa from occurrence
data. The function can calculate geographic range in four ways: convex
hull, latitudinal range, maximum Great Circle Distance, and the number of
occupied equal-area hexagonal grid cells."><meta property="og:image" content="https://palaeoverse.palaeoverse.org/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">palaeoverse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/phanerozoic-reefs.html">Latitudinal trends in Phanerozoic reefs</a></li>
    <li><a class="dropdown-item" href="../articles/tetrapod-biodiversity.html">Alpha diversity and geographic range size of Carboniferous and Permian tetrapods</a></li>
    <li><a class="dropdown-item" href="../articles/structure-and-standards.html">Contributing to palaeoverse: structure and standards</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/palaeoverse/palaeoverse/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate the geographic range of fossil taxa</h1>
      <small class="dont-index">Source: <a href="https://github.com/palaeoverse/palaeoverse/blob/main/R/tax_range_space.R" class="external-link"><code>R/tax_range_space.R</code></a></small>
      <div class="d-none name"><code>tax_range_space.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A function to calculate the geographic range of fossil taxa from occurrence
data. The function can calculate geographic range in four ways: convex
hull, latitudinal range, maximum Great Circle Distance, and the number of
occupied equal-area hexagonal grid cells.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tax_range_space</span><span class="op">(</span></span>
<span>  <span class="va">occdf</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"genus"</span>,</span>
<span>  lng <span class="op">=</span> <span class="st">"lng"</span>,</span>
<span>  lat <span class="op">=</span> <span class="st">"lat"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"lat"</span>,</span>
<span>  spacing <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  coords <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-occdf">occdf<a class="anchor" aria-label="anchor" href="#arg-occdf"></a></dt>
<dd><p><code>dataframe</code>. A dataframe of fossil occurrences. This
dataframe should contain at least three columns: names of taxa, longitude
and latitude (see <code>name</code>, <code>lng</code>, and <code>lat</code> arguments).</p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p><code>character</code>. The name of the column you wish to be treated
as the input names (e.g. "species" or "genus"). NA data should be removed
prior to function call.</p></dd>


<dt id="arg-lng">lng<a class="anchor" aria-label="anchor" href="#arg-lng"></a></dt>
<dd><p><code>character</code>. The name of the column you wish to be treated
as the input longitude (e.g. "lng" or "p_lng"). NA data should be removed
prior to function call.</p></dd>


<dt id="arg-lat">lat<a class="anchor" aria-label="anchor" href="#arg-lat"></a></dt>
<dd><p><code>character</code>. The name of the column you wish to be treated
as the input latitude (e.g. "lat" or "p_lat"). NA data should be removed
prior to function call.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p><code>character</code>. How should geographic range be calculated
for each taxon in <code>occdf</code>? Four options exist in this function: "con",
"lat", "gcd", and "occ". See Details for a description of each.</p></dd>


<dt id="arg-spacing">spacing<a class="anchor" aria-label="anchor" href="#arg-spacing"></a></dt>
<dd><p><code>numeric</code>. The desired spacing (in km) between the
center of adjacent grid cells. Only required if the <code>method</code> argument is
set to "occ". The default is 100.</p></dd>


<dt id="arg-coords">coords<a class="anchor" aria-label="anchor" href="#arg-coords"></a></dt>
<dd><p><code>logical</code>. Should the output coordinates be returned for
the "con" and "gcd" <code>method</code>?</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>dataframe</code> with method-specific columns:</p><ul><li><p>For the "con" method, a <code>dataframe</code> with each unique taxa (<code>taxon</code>)
and taxon ID (<code>taxon_id</code>) by convex hull coordinate (<code>lng</code> &amp; <code>lat</code>)
combination, and area (<code>area</code>) in
km<sup>2</sup> is returned.</p></li>
<li><p>For the "lat" method, a <code>dataframe</code> with unique taxa (<code>taxon</code>),
taxon ID (<code>taxon_id</code>), maximum latitude of occurrence (<code>max_lat</code>),
minimum latitude of occurrence (<code>min_lat</code>), and latitudinal
range (<code>range_lat</code>) is returned.</p></li>
<li><p>For the "gcd" method, a <code>dataframe</code> with each unique taxa (<code>taxon</code>)
and taxon ID (<code>taxon_id</code>) by coordinate combination (<code>lng</code> &amp; <code>lat</code>) of the
two most distant points, and the Great Circle Distance (<code>gcd</code>) between
these points in km is returned.</p></li>
<li><p>For the "occ" method, a <code>dataframe</code> with unique taxa (<code>taxon</code>), taxon
ID (<code>taxon_id</code>), the number of occupied cells (<code>n_cells</code>), proportion of
occupied cells from all occupied by occurrences (<code>proportional_occ</code>),
and the spacing between cells (<code>spacing</code>) in km is returned. Note: the number
of occupied cells and proportion of occupied cells is highly dependent on
the user-defined <code>spacing.</code>
For the "con", "lat" and "gcd" method, values of zero indicate that the
respective taxon is a singleton (i.e. represented by only one occurrence).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Four commonly applied approaches (Darroch et al. 2020)
are available using the <code>tax_range_space</code> function for calculating ranges:</p><ul><li><p>Convex hull: the "con" method calculates the geographic range of taxa
using a convex hull for each taxon in <code>occdf</code>, and calculates the area of
the convex hull (in km<sup>2</sup>) using
<code><a href="https://rdrr.io/pkg/geosphere/man/area.html" class="external-link">geosphere::areaPolygon()</a></code>. The
convex hull method works by creating a polygon that encompasses all
occurrence points of the taxon.</p></li>
<li><p>Latitudinal: the "lat" method calculates the palaeolatitudinal
range of a taxon. It does so for each taxon in <code>occdf</code> by finding their
maximum and minimum latitudinal occurrence (from input <code>lat</code>).
The palaeolatitudinal range of each taxon is also calculated (i.e. the
difference between the minimum and maximum latitude).</p></li>
<li><p>Maximum Great Circle Distance: the "gcd" method calculates the maximum
Great Circle Distance between occurrences for each taxon in <code>occdf</code>. It does
so using <code><a href="https://rdrr.io/pkg/geosphere/man/distHaversine.html" class="external-link">geosphere::distHaversine()</a></code>.
This function calculates Great Circle Distance using the Haversine method
with the radius of the Earth set to the 6378.137 km.
Great Circle Distance represents the shortest distance between two
points on the surface of a sphere. This is different from Euclidean Distance,
which represents the distance between two points on a plane.</p></li>
<li><p>Occupied cells: the "occ" method calculates the number and proportion of
occupied equal-area grid cells. It does so using discrete hexagonal grids
via the <code><a href="https://obrl-soil.github.io/h3jsr/reference/h3jsr-package.html" class="external-link">h3jsr</a></code> package. This package relies on
<a href="https://h3geo.org/docs/" class="external-link">Uber's H3</a> library, a geospatial indexing system
that partitions the world into hexagonal cells. In H3, 16 different
resolutions are available
(<a href="https://h3geo.org/docs/core-library/restable/" class="external-link">see here</a>).
In the implementation of the <code>tax_range_space()</code> function, the resolution is
defined by the user-input <code>spacing</code> which represents the distance between
the centroid of adjacent cells. Using this distance, the function identifies
which resolution is most similar to the input <code>spacing</code>, and uses this
resolution.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="reference-s-">Reference(s)<a class="anchor" aria-label="anchor" href="#reference-s-"></a></h2>


<p>Darroch, S. A., Casey, M. M., Antell, G. S., Sweeney, A., &amp; Saupe, E. E.
(2020). High preservation potential of paleogeographic range size
distributions in deep time. The American Naturalist, 196(4), 454-471.</p>
    </div>
    <div class="section level2">
    <h2 id="developer-s-">Developer(s)<a class="anchor" aria-label="anchor" href="#developer-s-"></a></h2>


<p>Lewis A. Jones</p>
    </div>
    <div class="section level2">
    <h2 id="reviewer-s-">Reviewer(s)<a class="anchor" aria-label="anchor" href="#reviewer-s-"></a></h2>


<p>Bethany Allen &amp; Christopher D. Dean</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Grab internal data</span></span></span>
<span class="r-in"><span><span class="va">occdf</span> <span class="op">&lt;-</span> <span class="va">tetrapods</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="co"># Remove NAs</span></span></span>
<span class="r-in"><span><span class="va">occdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">occdf</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">genus</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Convex hull</span></span></span>
<span class="r-in"><span><span class="va">ex1</span> <span class="op">&lt;-</span> <span class="fu">tax_range_space</span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">occdf</span>, name <span class="op">=</span> <span class="st">"genus"</span>, method <span class="op">=</span> <span class="st">"con"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Latitudinal range</span></span></span>
<span class="r-in"><span><span class="va">ex2</span> <span class="op">&lt;-</span> <span class="fu">tax_range_space</span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">occdf</span>, name <span class="op">=</span> <span class="st">"genus"</span>, method <span class="op">=</span> <span class="st">"lat"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Great Circle Distance</span></span></span>
<span class="r-in"><span><span class="va">ex3</span> <span class="op">&lt;-</span> <span class="fu">tax_range_space</span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">occdf</span>, name <span class="op">=</span> <span class="st">"genus"</span>, method <span class="op">=</span> <span class="st">"gcd"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Occupied grid cells</span></span></span>
<span class="r-in"><span><span class="va">ex4</span> <span class="op">&lt;-</span> <span class="fu">tax_range_space</span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">occdf</span>, name <span class="op">=</span> <span class="st">"genus"</span>,</span></span>
<span class="r-in"><span>                       method <span class="op">=</span> <span class="st">"occ"</span>, spacing <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Convex hull with coordinates</span></span></span>
<span class="r-in"><span><span class="va">ex5</span> <span class="op">&lt;-</span> <span class="fu">tax_range_space</span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">occdf</span>, name <span class="op">=</span> <span class="st">"genus"</span>, method <span class="op">=</span> <span class="st">"con"</span>,</span></span>
<span class="r-in"><span>coords <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.lewisajones.com" class="external-link">Lewis A. Jones</a>, <a href="https://williamgearty.com" class="external-link">William Gearty</a>, <a href="https://bsse.ethz.ch/cevo/the-group/people/person-detail.html?persid=295484" class="external-link">Bethany J. Allen</a>, <a href="https://keichenseer.netlify.app" class="external-link">Kilian Eichenseer</a>, <a href="https://www.ucl.ac.uk/earth-sciences/people/research-staff/dr-chris-dean" class="external-link">Christopher D. Dean</a>, <a href="https://www.researchgate.net/profile/Joseph-Flannery-Sutherland" class="external-link">Joseph T. Flannery-Sutherland</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

