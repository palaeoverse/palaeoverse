<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Add an axis with a geological timescale — axis_geo • palaeoverse</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Add an axis with a geological timescale — axis_geo"><meta name="description" content="axis_geo behaves similarly to axis in that it
adds an axis to the specified side of a base R plot. The main difference is
that it also adds a geological timescale between the plot and the axis. The
default scale includes international epochs from the the Geological Timescale
2020 (GTS2020). However, international stages, periods, eras,
and eons are also available. Interval data hosted by
Macrostrat are also available (see
time_bins). A custom interval dataset can also be used (see
Details below). The appearance of the axis is highly customisable (see Usage
below), with the intent that plots will be publication-ready."><meta property="og:description" content="axis_geo behaves similarly to axis in that it
adds an axis to the specified side of a base R plot. The main difference is
that it also adds a geological timescale between the plot and the axis. The
default scale includes international epochs from the the Geological Timescale
2020 (GTS2020). However, international stages, periods, eras,
and eons are also available. Interval data hosted by
Macrostrat are also available (see
time_bins). A custom interval dataset can also be used (see
Details below). The appearance of the axis is highly customisable (see Usage
below), with the intent that plots will be publication-ready."><meta property="og:image" content="https://palaeoverse.palaeoverse.org/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">palaeoverse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/phanerozoic-reefs.html">Latitudinal trends in Phanerozoic reefs</a></li>
    <li><a class="dropdown-item" href="../articles/tetrapod-biodiversity.html">Alpha diversity and geographic range size of Carboniferous and Permian tetrapods</a></li>
    <li><a class="dropdown-item" href="../articles/structure-and-standards.html">Contributing to palaeoverse: structure and standards</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/palaeoverse/palaeoverse/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Add an axis with a geological timescale</h1>
      <small class="dont-index">Source: <a href="https://github.com/palaeoverse/palaeoverse/blob/main/R/axis_geo.R" class="external-link"><code>R/axis_geo.R</code></a></small>
      <div class="d-none name"><code>axis_geo.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>axis_geo</code> behaves similarly to <code><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></code> in that it
adds an axis to the specified side of a base R plot. The main difference is
that it also adds a geological timescale between the plot and the axis. The
default scale includes international epochs from the the Geological Timescale
2020 (<code><a href="GTS2020.html">GTS2020</a></code>). However, international stages, periods, eras,
and eons are also available. Interval data hosted by
<a href="https://macrostrat.org" class="external-link">Macrostrat</a> are also available (see
<code><a href="time_bins.html">time_bins</a></code>). A custom interval dataset can also be used (see
Details below). The appearance of the axis is highly customisable (see Usage
below), with the intent that plots will be publication-ready.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">axis_geo</span><span class="op">(</span></span>
<span>  side <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  intervals <span class="op">=</span> <span class="st">"epoch"</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  fill <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lab <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  lab_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lab_size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  rot <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  abbr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  center_end_labels <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  autofit <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  skip <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Quaternary"</span>, <span class="st">"Holocene"</span>, <span class="st">"Late Pleistocene"</span><span class="op">)</span>,</span>
<span>  bord_col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"lty"</span><span class="op">)</span>,</span>
<span>  lwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"lwd"</span><span class="op">)</span>,</span>
<span>  bkgd <span class="op">=</span> <span class="st">"grey90"</span>,</span>
<span>  neg <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  exact <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  round <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  tick_at <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tick_labels <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  phylo <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  root.time <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">axis_geo_phylo</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-side">side<a class="anchor" aria-label="anchor" href="#arg-side"></a></dt>
<dd><p><code>integer</code>. Which side to add the axis to (<code>1</code>: bottom,
the default; <code>2</code>: left; <code>3</code>: top; <code>4</code>: right).</p></dd>


<dt id="arg-intervals">intervals<a class="anchor" aria-label="anchor" href="#arg-intervals"></a></dt>
<dd><p>The interval information to use to plot the axis: either A)
a <code>character</code> string indicating a rank of intervals from the built-in
<code><a href="GTS2020.html">GTS2020</a></code>, B) a <code>character</code> string indicating a
<code>data.frame</code> hosted by <a href="https://macrostrat.org" class="external-link">Macrostrat</a> (see
<code><a href="time_bins.html">time_bins</a></code>), or C) a custom <code>data.frame</code> of time interval
boundaries (see Details). A list of strings or data.frames can be supplied
to add multiple time scales to the same side of the plot (see Details).</p></dd>


<dt id="arg-height">height<a class="anchor" aria-label="anchor" href="#arg-height"></a></dt>
<dd><p><code>numeric</code>. The relative height (or width if <code>side</code> is
<code>2</code> or <code>4</code>) of the scale. This is relative to the height (if
<code>side</code> is <code>1</code> or <code>3</code>) or width (if <code>side</code> is <code>2</code>
or <code>4</code>) of the plot.</p></dd>


<dt id="arg-fill">fill<a class="anchor" aria-label="anchor" href="#arg-fill"></a></dt>
<dd><p><code>character</code>. The fill colour of the boxes. The default is to
use the <code>colour</code> or <code>color</code> column included in <code>intervals</code>.
If a custom dataset is provided with <code>intervals</code> without a
<code>colour</code> or <code>color</code> column and without specifying <code>fill</code>, a
greyscale will be used. Custom fill colours can be provided with this
option (overriding the <code>colour</code> or <code>color</code> column) and will be
recycled if/as necessary.</p></dd>


<dt id="arg-lab">lab<a class="anchor" aria-label="anchor" href="#arg-lab"></a></dt>
<dd><p><code>logical</code>. Should interval labels be included?</p></dd>


<dt id="arg-lab-col">lab_col<a class="anchor" aria-label="anchor" href="#arg-lab-col"></a></dt>
<dd><p><code>character</code>. The colour of the labels. The default is to
use the <code>font</code> or <code>lab_color</code> column included in
<code>intervals</code>. If a custom dataset is provided with <code>intervals</code>
without a <code>font</code> or <code>lab_color</code> column and without
specifying <code>lab_col</code>, all labels will be black. Custom label colours
can be provided with this option (overriding the <code>font</code> or
<code>lab_color</code> column) and will be recycled if/as necessary.</p></dd>


<dt id="arg-lab-size">lab_size<a class="anchor" aria-label="anchor" href="#arg-lab-size"></a></dt>
<dd><p><code>numeric</code>. The size of the labels (see <code>cex</code> in
<code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">graphics parameters</a></code>).</p></dd>


<dt id="arg-rot">rot<a class="anchor" aria-label="anchor" href="#arg-rot"></a></dt>
<dd><p><code>numeric</code>. The amount of counter-clockwise rotation to add to
the labels (in degrees). Note, labels for axes added to the left or right
sides are already rotated 90 degrees.</p></dd>


<dt id="arg-abbr">abbr<a class="anchor" aria-label="anchor" href="#arg-abbr"></a></dt>
<dd><p><code>logical</code>. Should labels be abbreviated? This only works
if the data has an <code>abbr</code> column, otherwise the <code>name</code> column
will be used regardless of this setting.</p></dd>


<dt id="arg-center-end-labels">center_end_labels<a class="anchor" aria-label="anchor" href="#arg-center-end-labels"></a></dt>
<dd><p><code>logical</code>. Should labels be centered within the
visible range of intervals at the ends of the axis?</p></dd>


<dt id="arg-autofit">autofit<a class="anchor" aria-label="anchor" href="#arg-autofit"></a></dt>
<dd><p><code>logical</code>. Should labels be automatically resized to fit
their interval boxes? If <code>TRUE</code>, <code>lab_size</code> will be used as the
maximum possible size of the labels. If <code>FALSE</code> (the default),
<code>lab_size</code> will be used as the size for all labels.</p></dd>


<dt id="arg-skip">skip<a class="anchor" aria-label="anchor" href="#arg-skip"></a></dt>
<dd><p>A <code>character</code> vector of interval names indicating which
intervals should not be labeled. If <code>abbr</code> is <code>TRUE</code>, this can
also include interval abbreviations. Quaternary, Holocene, and Late
Pleistocene are skipped by default. Set to NULL if this is not desired.</p></dd>


<dt id="arg-bord-col">bord_col<a class="anchor" aria-label="anchor" href="#arg-bord-col"></a></dt>
<dd><p><code>character</code>. The border colour of the interval boxes.</p></dd>


<dt id="arg-lty">lty<a class="anchor" aria-label="anchor" href="#arg-lty"></a></dt>
<dd><p><code>character</code>. Line type (see <code>lty</code> in
<code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">graphics parameters</a></code>). This value (or the last
value if this is a list) will also be passed to
<code><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></code>.</p></dd>


<dt id="arg-lwd">lwd<a class="anchor" aria-label="anchor" href="#arg-lwd"></a></dt>
<dd><p><code>numeric</code>. Line width (see <code>lwd</code> in
<code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">graphics parameters</a></code>).</p></dd>


<dt id="arg-bkgd">bkgd<a class="anchor" aria-label="anchor" href="#arg-bkgd"></a></dt>
<dd><p><code>character</code>. The colour of the background of the scale
when no intervals are being shown.</p></dd>


<dt id="arg-neg">neg<a class="anchor" aria-label="anchor" href="#arg-neg"></a></dt>
<dd><p><code>logical</code>. Set this to <code>TRUE</code> if your x-axis is using
negative values. If the entire axis is already negative, this will be set
to <code>TRUE</code> for you.</p></dd>


<dt id="arg-exact">exact<a class="anchor" aria-label="anchor" href="#arg-exact"></a></dt>
<dd><p><code>logical</code>. Set this to <code>TRUE</code> if you want axis tick
marks and numeric tick labels placed at the interval boundaries. If
<code>TRUE</code>, this overrides <code>tick_at</code> and <code>tick_labels</code>.</p></dd>


<dt id="arg-round">round<a class="anchor" aria-label="anchor" href="#arg-round"></a></dt>
<dd><p><code>integer</code>. Number of decimal places to which exact axis
labels should be rounded (using <code><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></code>). If no value is
specified, the exact values will be used. Trailing zeros are always
removed. <code>tick_at</code> and <code>tick_labels</code> can be used to include
labels with trailing zeros.</p></dd>


<dt id="arg-tick-at">tick_at<a class="anchor" aria-label="anchor" href="#arg-tick-at"></a></dt>
<dd><p>A <code>numeric</code> vector specifying custom points at which tick
marks are to be drawn on the axis. If specified, this is passed directly to
<code><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></code>. If <code>phylo</code> is <code>TRUE</code>, these values
are converted as necessary for the phylogenetic axis limits. If this is set
to <code>NULL</code> (the default) tick mark locations are computed automatically
(see <code><a href="https://rdrr.io/r/graphics/axTicks.html" class="external-link">axTicks</a></code>).</p></dd>


<dt id="arg-tick-labels">tick_labels<a class="anchor" aria-label="anchor" href="#arg-tick-labels"></a></dt>
<dd><p>Either a) a <code>logical</code> value specifying whether
(numerical) annotations should be made at the tick marks specified by
<code>tick_at</code>, or b) a custom <code>character</code> or <code>expression</code> vector
of labels to be placed at the tick marks. If <code>tick_at</code> is specified,
this argument is passed directly to <code><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></code>.</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p><code>character</code>. An axis title to be added outside of the
specified axis. This is passed directly to <code><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></code>.
If this is set to <code>NULL</code> (the default), no title will be added.</p></dd>


<dt id="arg-phylo">phylo<a class="anchor" aria-label="anchor" href="#arg-phylo"></a></dt>
<dd><p><code>logical</code>. Is the base plot a phylogeny generated by
<code><a href="https://rdrr.io/pkg/ape/man/plot.phylo.html" class="external-link">plot.phylo</a></code>, <code><a href="https://rdrr.io/pkg/phytools/man/plotTree.html" class="external-link">plotTree</a></code>,
<code><a href="https://rdrr.io/pkg/phytools/man/plotSimmap.html" class="external-link">plotSimmap</a></code>, etc?</p></dd>


<dt id="arg-root-time">root.time<a class="anchor" aria-label="anchor" href="#arg-root-time"></a></dt>
<dd><p><code>numeric</code>. If <code>phylo</code> is <code>TRUE</code>, this is the
time assigned to the root node of the tree. By default, this is taken from
the <code>root.time</code> element of the plotted tree.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments that are passed directly to
<code><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></code> and <code><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>No return value. Function is used for its side effect, which is to
add an axis of the geological timescale to an already existing plot.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If a custom <code>data.frame</code> is provided (with <code>intervals</code>), it should
consist of at least 3 columns of data. See <code><a href="GTS2020.html">GTS2020</a></code> for an
example.</p><ul><li><p>The <code>interval_name</code> column (<code>name</code> is also allowed) lists
the names of each time interval. These will be used as labels if no
abbreviations are provided.</p></li>
<li><p>The <code>max_ma</code> column (<code>max_age</code> is also allowed) lists the
oldest boundary of each time interval. Values should always be
positive.</p></li>
<li><p>The <code>min_ma</code> column (<code>min_age</code> is also allowed) lists the
youngest boundary of each time interval. Values should always be
positive.</p></li>
<li><p>The <code>abbr</code> column is optional and lists abbreviations that may
be used as labels.</p></li>
<li><p>The <code>colour</code> column (<code>color</code> is also allowed) is also
optional and lists a colour for the background for each time interval
(see the Color Specification section
<code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">here</a></code>).</p></li>
<li><p>The <code>font</code> (<code>lab_color</code> is also allowed) column is
also optional and lists a colour for the label for each time interval
(see the Color Specification section
<code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">here</a></code>).</p></li>
</ul><p><code>intervals</code> may also be a list if multiple time scales should be added
to a single side of the plot. In this case, <code>height</code>, <code>fill</code>,
<code>lab</code>, <code>lab_col</code>, <code>lab_size</code>, <code>rot</code>, <code>abbr</code>,
<code>center_end_labels</code>, <code>skip</code>, <code>bord_col</code>, <code>lty</code>,
<code>lwd</code>, and <code>autofit</code> can also be lists. If these lists are not as
long as <code>intervals</code>, the elements will be recycled. If individual values
(or vectors, e.g. for <code>skip</code>) are used for these parameters, they will
be applied to all time scales (and recycled as necessary). If multiple scales
are requested they will be added sequentially outwards starting from the plot
border.</p>
<p>An axis will always be placed on the outside of the last scale using
<code><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></code>. If the <code>title</code> argument is supplied, an
axis title will be added outside of this using <code><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></code>.
Additional arguments, including various
<code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">graphics parameters</a></code>, that are supplied to
<code>axis_geo</code> will be passed to both of these functions (e.g. <code>tck</code> to
control the length of the tick marks, <code>mgp</code> to control the title and
tick label locations, and <code>col</code> to control the axis and title color,
etc.). Note that the title is always placed at the middle of the axis. This
may not be desirable for phylogenetic trees, where the title may be better if
offset on the axis. In these and other cases, users should manually add the
title using <code><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></code>.</p>
<p>If you would like to use intervals from the Geological Time Scale 2012
(<code><a href="GTS2012.html">GTS2012</a></code>), you can use <code><a href="time_bins.html">time_bins</a></code> and supply the
returned <code>data.frame</code> to the <code>intervals</code> argument.</p>
<p><code>axis_geo_phylo(...)</code> is shorthand for
<code>axis_geo(..., phylo = TRUE)</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="authors">Authors<a class="anchor" aria-label="anchor" href="#authors"></a></h2>


<p>William Gearty &amp; Kilian Eichenseer</p>
    </div>
    <div class="section level2">
    <h2 id="reviewer">Reviewer<a class="anchor" aria-label="anchor" href="#reviewer"></a></h2>


<p>Lewis A. Jones</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># track user par</span></span></span>
<span class="r-in"><span><span class="va">oldpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># single scale on bottom</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span><span class="op">)</span><span class="op">)</span> <span class="co"># modify margin</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">100</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     xlab <span class="op">=</span> <span class="cn">NA</span>, ylab <span class="op">=</span> <span class="st">"Depth (m)"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">axis_geo</span><span class="op">(</span>side <span class="op">=</span> <span class="fl">1</span>, intervals <span class="op">=</span> <span class="st">"period"</span>, title <span class="op">=</span> <span class="st">"Time (Ma)"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="axis_geo-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># stack multiple scales, abbreviate only one set of labels</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span><span class="op">)</span><span class="op">)</span> <span class="co"># further expand bottom margin</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">100</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     xlab <span class="op">=</span> <span class="cn">NA</span>, ylab <span class="op">=</span> <span class="st">"Depth (m)"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">axis_geo</span><span class="op">(</span>side <span class="op">=</span> <span class="fl">1</span>, intervals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"epoch"</span>, <span class="st">"period"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         abbr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>, title <span class="op">=</span> <span class="st">"Time (Ma)"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="axis_geo-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># scale with Macrostrat intervals</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span><span class="op">)</span><span class="op">)</span> <span class="co"># modify margin</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">30</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">0</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     xlab <span class="op">=</span> <span class="cn">NA</span>, ylab <span class="op">=</span> <span class="st">"Depth (m)"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># this time, add a title automatically with axis_geo()</span></span></span>
<span class="r-in"><span><span class="fu">axis_geo</span><span class="op">(</span>side <span class="op">=</span> <span class="fl">1</span>, intervals <span class="op">=</span> <span class="st">"North American land mammal ages"</span>,</span></span>
<span class="r-in"><span>         title <span class="op">=</span> <span class="st">"Time (Ma)"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="axis_geo-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># scale with custom intervals</span></span></span>
<span class="r-in"><span><span class="va">intervals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>min_ma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">25</span>, <span class="fl">32</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        max_ma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">25</span>, <span class="fl">32</span>, <span class="fl">40</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        interval_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span><span class="op">)</span><span class="op">)</span> <span class="co"># modify margin</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">40</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">0</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     xlab <span class="op">=</span> <span class="cn">NA</span>, ylab <span class="op">=</span> <span class="st">"Depth (m)"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">axis_geo</span><span class="op">(</span>side <span class="op">=</span> <span class="fl">1</span>, intervals <span class="op">=</span> <span class="va">intervals</span>, title <span class="op">=</span> <span class="st">"Time (Ma)"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="axis_geo-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># scale with phylogeny</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/liamrevell/phytools" class="external-link">phytools</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mammal.tree</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mammal.tree</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">axis_geo_phylo</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Time (Ma)"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="axis_geo-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># scale with fossil phylogeny</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dwbapst/paleotree" class="external-link">paleotree</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">RaiaCopesRule</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ceratopsianTreeRaia</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">axis_geo_phylo</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Time (Ma)"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="axis_geo-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># reset user par</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">oldpar</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.lewisajones.com" class="external-link">Lewis A. Jones</a>, <a href="https://williamgearty.com" class="external-link">William Gearty</a>, <a href="https://bsse.ethz.ch/cevo/the-group/people/person-detail.html?persid=295484" class="external-link">Bethany J. Allen</a>, <a href="https://keichenseer.netlify.app" class="external-link">Kilian Eichenseer</a>, <a href="https://www.ucl.ac.uk/earth-sciences/people/research-staff/dr-chris-dean" class="external-link">Christopher D. Dean</a>, <a href="https://www.researchgate.net/profile/Joseph-Flannery-Sutherland" class="external-link">Joseph T. Flannery-Sutherland</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

