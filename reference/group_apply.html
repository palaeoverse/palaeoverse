<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Apply a function over grouping(s) of data — group_apply • palaeoverse</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Apply a function over grouping(s) of data — group_apply"><meta name="description" content="A function to apply palaeoverse functionality across subsets (groups) of
data, delineated using one or more variables. Functions which receive a
data.frame as input (e.g. nrow, ncol, lengths, unique) may also be
used."><meta property="og:description" content="A function to apply palaeoverse functionality across subsets (groups) of
data, delineated using one or more variables. Functions which receive a
data.frame as input (e.g. nrow, ncol, lengths, unique) may also be
used."><meta property="og:image" content="https://palaeoverse.palaeoverse.org/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">palaeoverse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/phanerozoic-reefs.html">Latitudinal trends in Phanerozoic reefs</a></li>
    <li><a class="dropdown-item" href="../articles/tetrapod-biodiversity.html">Alpha diversity and geographic range size of Carboniferous and Permian tetrapods</a></li>
    <li><a class="dropdown-item" href="../articles/structure-and-standards.html">Contributing to palaeoverse: structure and standards</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/palaeoverse/palaeoverse/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Apply a function over grouping(s) of data</h1>
      <small class="dont-index">Source: <a href="https://github.com/palaeoverse/palaeoverse/blob/main/R/group_apply.R" class="external-link"><code>R/group_apply.R</code></a></small>
      <div class="d-none name"><code>group_apply.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A function to apply <code>palaeoverse</code> functionality across subsets (groups) of
data, delineated using one or more variables. Functions which receive a
<code>data.frame</code> as input (e.g. <code>nrow</code>, <code>ncol</code>, <code>lengths</code>, <code>unique</code>) may also be
used.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">group_apply</span><span class="op">(</span><span class="va">occdf</span>, <span class="va">group</span>, <span class="va">fun</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-occdf">occdf<a class="anchor" aria-label="anchor" href="#arg-occdf"></a></dt>
<dd><p><code>dataframe</code>. A dataframe of fossil occurrences or taxa,
as relevant to the desired function.
This dataframe must contain the grouping variables and the necessary
variables for the function you wish to call (see function-specific
documentation for required columns).</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p><code>character</code>. A vector of column names, specifying the
desired subgroups (e.g. "collection_no", "stage_bin"). Supplying more than
one grouping variable will produce an output containing subgroups for each
unique combination of values.</p></dd>


<dt id="arg-fun">fun<a class="anchor" aria-label="anchor" href="#arg-fun"></a></dt>
<dd><p><code>function</code>. The function you wish to apply to
<code>occdf</code>. See details for compatible functions.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments available in the called
function. These arguments may be required for function arguments
without default values, or if you wish to overwrite the default argument
value (see examples).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>data.frame</code> of the outputs from the selected function, with
appended column(s) indicating the user-defined groups. If a single vector
is returned via the called function, it will be transformed to a
<code>data.frame</code> with the column name equal to the input function.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>group_apply</code> applies functions to subgroups of data within a
supplied dataset, enabling the separate analysis of occurrences or taxa from
different time intervals, spatial regions, or trait values. The function
serves as a wrapper around <code>palaeoverse</code> functions. Other functions which
can be applied to a <code>data.frame</code> (e.g. <code>nrow</code>, <code>ncol</code>, <code>lengths</code>,
<code>unique</code>) may also be used.
<br><br>
All <code>palaeoverse</code> functions which require a dataframe input can be used in
conjunction with the <code>group_apply</code> function. However, this is unnecessary
for many functions (e.g. <code><a href="bin_time.html">bin_time</a></code>) as groups do not need to
be partitioned before binning. This list provides
users with <code>palaeoverse</code> functions that might be interesting to apply across
group(s):</p><ul><li><p><code><a href="tax_unique.html">tax_unique</a></code>: return the number of unique taxa per grouping
variable.</p></li>
<li><p><code><a href="tax_range_time.html">tax_range_time</a></code>: return the temporal range of taxa per
grouping variable.</p></li>
<li><p><code><a href="tax_range_space.html">tax_range_space</a></code>: return the geographic range of taxa per
grouping variable.</p></li>
<li><p><code><a href="tax_check.html">tax_check</a></code>: return potential spelling variations of the
same taxon per grouping variable. Note: <code>verbose</code> needs to be set to FALSE.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="developer-s-">Developer(s)<a class="anchor" aria-label="anchor" href="#developer-s-"></a></h2>


<p>Lewis A. Jones &amp; William Gearty</p>
    </div>
    <div class="section level2">
    <h2 id="reviewer-s-">Reviewer(s)<a class="anchor" aria-label="anchor" href="#reviewer-s-"></a></h2>


<p>Kilian Eichenseer &amp; Bethany Allen</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Examples</span></span></span>
<span class="r-in"><span><span class="co"># Get tetrapods data</span></span></span>
<span class="r-in"><span><span class="va">occdf</span> <span class="op">&lt;-</span> <span class="va">tetrapods</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="co"># Remove NA data</span></span></span>
<span class="r-in"><span><span class="va">occdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">occdf</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">genus</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Count number of occurrences from each country</span></span></span>
<span class="r-in"><span><span class="va">ex1</span> <span class="op">&lt;-</span> <span class="fu">group_apply</span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">occdf</span>, group <span class="op">=</span> <span class="st">"cc"</span>, fun <span class="op">=</span> <span class="va">nrow</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Unique genera per collection with group_apply and input arguments</span></span></span>
<span class="r-in"><span><span class="va">ex2</span> <span class="op">&lt;-</span> <span class="fu">group_apply</span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">occdf</span>,</span></span>
<span class="r-in"><span>                     group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"collection_no"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     fun <span class="op">=</span> <span class="va">tax_unique</span>,</span></span>
<span class="r-in"><span>                     genus <span class="op">=</span> <span class="st">"genus"</span>,</span></span>
<span class="r-in"><span>                     family <span class="op">=</span> <span class="st">"family"</span>,</span></span>
<span class="r-in"><span>                     order <span class="op">=</span> <span class="st">"order"</span>,</span></span>
<span class="r-in"><span>                     class <span class="op">=</span> <span class="st">"class"</span>,</span></span>
<span class="r-in"><span>                     resolution <span class="op">=</span> <span class="st">"genus"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Use multiple variables (number of occurrences per collection and formation)</span></span></span>
<span class="r-in"><span><span class="va">ex3</span> <span class="op">&lt;-</span> <span class="fu">group_apply</span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">occdf</span>,</span></span>
<span class="r-in"><span>                   group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"collection_no"</span>, <span class="st">"formation"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   fun <span class="op">=</span> <span class="va">nrow</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Compute counts of occurrences per latitudinal bin</span></span></span>
<span class="r-in"><span><span class="co"># Set up lat bins</span></span></span>
<span class="r-in"><span><span class="va">bins</span> <span class="op">&lt;-</span> <span class="fu"><a href="lat_bins_degrees.html">lat_bins_degrees</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># bin occurrences</span></span></span>
<span class="r-in"><span><span class="va">occdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="bin_lat.html">bin_lat</a></span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">occdf</span>, bins <span class="op">=</span> <span class="va">bins</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Calculate number of occurrences per bin</span></span></span>
<span class="r-in"><span><span class="va">ex4</span> <span class="op">&lt;-</span> <span class="fu">group_apply</span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">occdf</span>, group <span class="op">=</span> <span class="st">"lat_bin"</span>, fun <span class="op">=</span> <span class="va">nrow</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.lewisajones.com" class="external-link">Lewis A. Jones</a>, <a href="https://williamgearty.com" class="external-link">William Gearty</a>, <a href="https://bsse.ethz.ch/cevo/the-group/people/person-detail.html?persid=295484" class="external-link">Bethany J. Allen</a>, <a href="https://keichenseer.netlify.app" class="external-link">Kilian Eichenseer</a>, <a href="https://www.ucl.ac.uk/earth-sciences/people/research-staff/dr-chris-dean" class="external-link">Christopher D. Dean</a>, <a href="https://www.researchgate.net/profile/Joseph-Flannery-Sutherland" class="external-link">Joseph T. Flannery-Sutherland</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

