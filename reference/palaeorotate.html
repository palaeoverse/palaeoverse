<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Palaeorotate fossil occurrences — palaeorotate • palaeoverse</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Palaeorotate fossil occurrences — palaeorotate"><meta name="description" content="A function to estimate palaeocoordinates for fossil occurrence data
(i.e. reconstruct the geographic distribution of organisms'
remains at time of deposition). Each occurrence is assigned
palaeocoordinates based on its current geographic position and age
estimate."><meta property="og:description" content="A function to estimate palaeocoordinates for fossil occurrence data
(i.e. reconstruct the geographic distribution of organisms'
remains at time of deposition). Each occurrence is assigned
palaeocoordinates based on its current geographic position and age
estimate."><meta property="og:image" content="https://palaeoverse.palaeoverse.org/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">palaeoverse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/phanerozoic-reefs.html">Latitudinal trends in Phanerozoic reefs</a></li>
    <li><a class="dropdown-item" href="../articles/tetrapod-biodiversity.html">Alpha diversity and geographic range size of Carboniferous and Permian tetrapods</a></li>
    <li><a class="dropdown-item" href="../articles/structure-and-standards.html">Contributing to palaeoverse: structure and standards</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/palaeoverse/palaeoverse/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Palaeorotate fossil occurrences</h1>
      <small class="dont-index">Source: <a href="https://github.com/palaeoverse/palaeoverse/blob/main/R/palaeorotate.R" class="external-link"><code>R/palaeorotate.R</code></a></small>
      <div class="d-none name"><code>palaeorotate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A function to estimate palaeocoordinates for fossil occurrence data
(i.e. reconstruct the geographic distribution of organisms'
remains at time of deposition). Each occurrence is assigned
palaeocoordinates based on its current geographic position and age
estimate.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">palaeorotate</span><span class="op">(</span></span>
<span>  <span class="va">occdf</span>,</span>
<span>  lng <span class="op">=</span> <span class="st">"lng"</span>,</span>
<span>  lat <span class="op">=</span> <span class="st">"lat"</span>,</span>
<span>  age <span class="op">=</span> <span class="st">"age"</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"MERDITH2021"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>  uncertainty <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  round <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-occdf">occdf<a class="anchor" aria-label="anchor" href="#arg-occdf"></a></dt>
<dd><p><code>data.frame</code>. Fossil occurrences to be
palaeogeographically reconstructed. <code>occdf</code> should contain columns
with longitudinal and latitudinal coordinates, as well as age estimates.
The age of rotation should be supplied in millions of years before
present.</p></dd>


<dt id="arg-lng">lng<a class="anchor" aria-label="anchor" href="#arg-lng"></a></dt>
<dd><p><code>character</code>. The name of the column you wish to be treated
as longitude (defaults to "lng").</p></dd>


<dt id="arg-lat">lat<a class="anchor" aria-label="anchor" href="#arg-lat"></a></dt>
<dd><p><code>character</code>. The name of the column you wish to be treated
as latitude (defaults to "lat").</p></dd>


<dt id="arg-age">age<a class="anchor" aria-label="anchor" href="#arg-age"></a></dt>
<dd><p><code>character</code>. The name of the column you wish to be treated
as the age for rotation (defaults to "age").</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p><code>character</code>. The name(s) of the Global Plate Model(s)
to be used to reconstruct palaeocoordinates. See details for available
models.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p><code>character</code>. Method used to calculate palaeocoordinates
for fossil occurrences. Either "grid" to use reconstruction files, or
"point" (default) to use the GPlates API service. See details section for
specific details.</p></dd>


<dt id="arg-uncertainty">uncertainty<a class="anchor" aria-label="anchor" href="#arg-uncertainty"></a></dt>
<dd><p><code>logical</code>. Should the uncertainty in
palaeogeographic reconstructions be returned? If set to TRUE (default),
the palaeolatitudinal range and maximum geographic distance (in km)
between output palaeocoordinates are calculated. This argument is only
relevant if more than one Global Plate Model is specified in <code>model</code>.</p></dd>


<dt id="arg-round">round<a class="anchor" aria-label="anchor" href="#arg-round"></a></dt>
<dd><p><code>numeric</code>. Numeric value indicating the number of decimal
places <code>lng</code>, <code>lat</code> and <code>age</code> should be rounded to. This functionality is
only relevant for the "point" <code>method</code>. Rounding can speed up
palaeorotation by reducing the number of unique coordinate pairs.
Defaults to a value of 3. If no rounding is desired, set this value to
<code>NULL</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>data.frame</code> containing the original input occurrence
<code>data.frame</code> and the reconstructed coordinates (i.e. "p_lng", "p_lat"). The
"grid" <code>method</code> also returns the age of rotation ("rot_age") and the
reference coordinates rotated ("rot_lng" and "rot_lat"). If only one
model is requested, a column containing the rotation model used
("rot_model") is also appended. Otherwise, the name of each model is
appended to the name of each column containing palaeocoordinates (e.g.
"p_lng_GOLONKA"). If <code>uncertainty</code> is set to <code>TRUE</code>, the
palaeolatitudinal range ("range_p_lat") and the maximum geographic
distance ("max_dist") in km between palaeocoordinates will also be
returned (the latter calculated via <code><a href="https://rdrr.io/pkg/geosphere/man/distGeo.html" class="external-link">distGeo</a></code>).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function can estimate palaeocoordinates using two different
approaches (<code>method</code>):</p><ul><li><p>Reconstruction files: The "grid" <code>method</code> uses reconstruction files from
Jones &amp; Domeier (2024) to spatiotemporally link present-day geographic
coordinates and age estimates with a discrete global grid rotated at one
million-year time steps throughout the Phanerozoic (540–0 Ma). Here,
resolution 3 (~119 km spacing) of the reconstruction files is used. All
files, and the process used to generate them, are available and documented
in Jones &amp; Domeier (2024). If fine-scale spatial analyses are being
conducted, use of the "point" <code>method</code> (see GPlates API below) may be
preferred (particularly if occurrences are close to plate boundaries). When
using the "grid" <code>method</code>, coordinates within the same grid cell will be
assigned equivalent palaeocoordinates due to spatial aggregation. However,
this approach enables efficient estimation of the past distribution of
fossil occurrences. Note: each reconstruction file is ~45 MB in size.</p></li>
<li><p>GPlates API: The "point" <code>method</code> uses the <a href="https://gwsdoc.gplates.org" class="external-link">GPlates Web Service</a> to reconstruct palaeocoordinates for point
data. The use of this <code>method</code> is slower than the "grid" <code>method</code> if many
unique time intervals exist in your dataset. However, it provides
palaeocoordinates with higher precision.</p></li>
</ul><p>Available models and timespan for each <code>method</code>:</p><ul><li><p>"MERDITH2021" (Merdith et al., 2021)</p><ul><li><p>0–1000 Ma (point)</p></li>
<li><p>0–540 Ma (grid)</p></li>
</ul></li>
<li><p>"TorsvikCocks2017" (Torsvik and Cocks, 2016)</p><ul><li><p>0–540 Ma (point/grid)</p></li>
</ul></li>
<li><p>"PALEOMAP" (Scotese, 2016)</p><ul><li><p>0–1100 Ma (point)</p></li>
<li><p>0–540 Ma (grid)</p></li>
</ul></li>
<li><p>"MATTHEWS2016_pmag_ref"  (Matthews et al., 2016)</p><ul><li><p>0–410 Ma (grid/point)</p></li>
</ul></li>
<li><p>"GOLONKA" (Wright et al., 2013)</p><ul><li><p>0–540 Ma (grid/point)</p></li>
</ul></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>


<ul><li><p>Jones, L.A., Domeier, M. A Phanerozoic gridded dataset for palaeogeographic
reconstructions. Sci Data 11, 710 (2024). <a href="https://doi.org/10.1038/s41597-024-03468-w" class="external-link">doi:10.1038/s41597-024-03468-w</a>
.</p></li>
<li><p>Matthews, K.J., Maloney, K.T., Zahirovic, S., Williams, S.E., Seton, M.,
and Müller, R.D. (2016). Global plate boundary evolution and kinematics
since the late Paleozoic. Global and Planetary Change, 146, 226-250.
<a href="https://doi.org/10.1016/j.gloplacha.2016.10.002" class="external-link">doi:10.1016/j.gloplacha.2016.10.002</a>
.</p></li>
<li><p>Merdith, A., Williams, S.E., Collins, A.S., Tetley, M.G., Mulder, J.A.,
Blades, M.L., Young, A., Armistead, S.E., Cannon, J., Zahirovic, S.,
Müller. R.D. (2021). Extending full-plate tectonic models into deep time:
Linking the Neoproterozoic and the Phanerozoic. Earth-Science Reviews,
214(103477). <a href="https://doi.org/10.1016/j.earscirev.2020.103477" class="external-link">doi:10.1016/j.earscirev.2020.103477</a>
.</p></li>
<li><p>Scotese, C., &amp; Wright, N. M. (2018). PALEOMAP Paleodigital Elevation Models
(PaleoDEMs) for the Phanerozoic. <a href="https://www.earthbyte.org/paleodem-resource-scotese-and-wright-2018/" class="external-link">PALEOMAP Project</a>.</p></li>
<li><p>Torsvik, T. H. &amp; Cocks, L. R. M. Earth History and Palaeogeography.
Cambridge University Press, 2016.</p></li>
<li><p>Wright, N., Zahirovic, S., Müller, R. D., &amp; Seton, M. (2013). Towards
community-driven paleogeographic reconstructions: integrating open-access
paleogeographic and paleobiology data with plate tectonics. Biogeosciences,
10(3), 1529-1541. <a href="https://doi.org/10.5194/bg-10-1529-2013" class="external-link">doi:10.5194/bg-10-1529-2013</a>
.</p></li>
</ul><p>See <a href="https://gwsdoc.gplates.org/reconstruction" class="external-link">GPlates documentation</a>
for additional information and details.</p>
    </div>
    <div class="section level2">
    <h2 id="developer-s-">Developer(s)<a class="anchor" aria-label="anchor" href="#developer-s-"></a></h2>


<p>Lewis A. Jones</p>
    </div>
    <div class="section level2">
    <h2 id="reviewer-s-">Reviewer(s)<a class="anchor" aria-label="anchor" href="#reviewer-s-"></a></h2>


<p>Kilian Eichenseer, Lucas Buffan &amp; Will Gearty</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">#Generic example with a few occurrences</span></span></span>
<span class="r-in"><span><span class="va">occdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>lng <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="op">-</span><span class="fl">103</span>, <span class="op">-</span><span class="fl">66</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">46</span>, <span class="fl">35</span>, <span class="op">-</span><span class="fl">7</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">88</span>, <span class="fl">125</span>, <span class="fl">200</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Calculate palaeocoordinates using reconstruction files</span></span></span>
<span class="r-in"><span><span class="va">ex1</span> <span class="op">&lt;-</span> <span class="fu">palaeorotate</span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">occdf</span>, method <span class="op">=</span> <span class="st">"grid"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Calculate palaeocoordinates using the GPlates API</span></span></span>
<span class="r-in"><span><span class="va">ex2</span> <span class="op">&lt;-</span> <span class="fu">palaeorotate</span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">occdf</span>, method <span class="op">=</span> <span class="st">"point"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Calculate uncertainity in palaeocoordinates from models</span></span></span>
<span class="r-in"><span><span class="va">ex3</span> <span class="op">&lt;-</span> <span class="fu">palaeorotate</span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">occdf</span>,</span></span>
<span class="r-in"><span>                    method <span class="op">=</span> <span class="st">"grid"</span>,</span></span>
<span class="r-in"><span>                    model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MERDITH2021"</span>,</span></span>
<span class="r-in"><span>                              <span class="st">"GOLONKA"</span>,</span></span>
<span class="r-in"><span>                              <span class="st">"PALEOMAP"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    uncertainty <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Now with some real fossil occurrence data!</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Grab some data from the Paleobiology Database</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tetrapods</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Assign midpoint age of fossil occurrence data for reconstruction</span></span></span>
<span class="r-in"><span><span class="va">tetrapods</span><span class="op">$</span><span class="va">age</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">tetrapods</span><span class="op">$</span><span class="va">max_ma</span> <span class="op">+</span> <span class="va">tetrapods</span><span class="op">$</span><span class="va">min_ma</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Rotate the data</span></span></span>
<span class="r-in"><span><span class="va">ex3</span> <span class="op">&lt;-</span> <span class="fu">palaeorotate</span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">tetrapods</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Calculate uncertainity in palaeocoordinates from models</span></span></span>
<span class="r-in"><span><span class="va">ex4</span> <span class="op">&lt;-</span> <span class="fu">palaeorotate</span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">tetrapods</span>,</span></span>
<span class="r-in"><span>                    model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MERDITH2021"</span>,</span></span>
<span class="r-in"><span>                              <span class="st">"GOLONKA"</span>,</span></span>
<span class="r-in"><span>                              <span class="st">"PALEOMAP"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    uncertainty <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.lewisajones.com" class="external-link">Lewis A. Jones</a>, <a href="https://williamgearty.com" class="external-link">William Gearty</a>, <a href="https://bsse.ethz.ch/cevo/the-group/people/person-detail.html?persid=295484" class="external-link">Bethany J. Allen</a>, <a href="https://keichenseer.netlify.app" class="external-link">Kilian Eichenseer</a>, <a href="https://www.ucl.ac.uk/earth-sciences/people/research-staff/dr-chris-dean" class="external-link">Christopher D. Dean</a>, <a href="https://www.researchgate.net/profile/Joseph-Flannery-Sutherland" class="external-link">Joseph T. Flannery-Sutherland</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

