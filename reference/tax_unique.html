<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Filter occurrences to unique taxa — tax_unique • palaeoverse</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Filter occurrences to unique taxa — tax_unique"><meta name="description" content='A function to filter a list of taxonomic occurrences to unique taxa of a
predefined resolution. Occurrences identified to a coarser taxonomic
resolution than the desired level are retained if they belong to a clade
which is not otherwise represented in the dataset (see details section for
further information). This has previously been described as "cryptic
diversity" (e.g. Mannion et al. 2011).'><meta property="og:description" content='A function to filter a list of taxonomic occurrences to unique taxa of a
predefined resolution. Occurrences identified to a coarser taxonomic
resolution than the desired level are retained if they belong to a clade
which is not otherwise represented in the dataset (see details section for
further information). This has previously been described as "cryptic
diversity" (e.g. Mannion et al. 2011).'><meta property="og:image" content="https://palaeoverse.palaeoverse.org/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">palaeoverse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/phanerozoic-reefs.html">Latitudinal trends in Phanerozoic reefs</a></li>
    <li><a class="dropdown-item" href="../articles/tetrapod-biodiversity.html">Alpha diversity and geographic range size of Carboniferous and Permian tetrapods</a></li>
    <li><a class="dropdown-item" href="../articles/structure-and-standards.html">Contributing to palaeoverse: structure and standards</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/palaeoverse/palaeoverse/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Filter occurrences to unique taxa</h1>
      <small class="dont-index">Source: <a href="https://github.com/palaeoverse/palaeoverse/blob/main/R/tax_unique.R" class="external-link"><code>R/tax_unique.R</code></a></small>
      <div class="d-none name"><code>tax_unique.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A function to filter a list of taxonomic occurrences to unique taxa of a
predefined resolution. Occurrences identified to a coarser taxonomic
resolution than the desired level are retained if they belong to a clade
which is not otherwise represented in the dataset (see details section for
further information). This has previously been described as "cryptic
diversity" (e.g. Mannion et al. 2011).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tax_unique</span><span class="op">(</span></span>
<span>  occdf <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  binomial <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  species <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  genus <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  resolution <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>  append <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-occdf">occdf<a class="anchor" aria-label="anchor" href="#arg-occdf"></a></dt>
<dd><p><code>dataframe</code>. A dataframe containing information on the
occurrences or taxa to filter.</p></dd>


<dt id="arg-binomial">binomial<a class="anchor" aria-label="anchor" href="#arg-binomial"></a></dt>
<dd><p><code>character</code>. The name of the column in <code>occdf</code>
containing the genus and species names of the occurrences, either in the
form "genus species" or "genus_species".</p></dd>


<dt id="arg-species">species<a class="anchor" aria-label="anchor" href="#arg-species"></a></dt>
<dd><p><code>character</code>. The name of the column in <code>occdf</code>
containing the species-level identifications (i.e. the specific epithet).</p></dd>


<dt id="arg-genus">genus<a class="anchor" aria-label="anchor" href="#arg-genus"></a></dt>
<dd><p><code>character</code>. The name of the column in <code>occdf</code>
containing the genus-level identifications.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p><code>character</code>. Other named arguments specifying columns of
higher levels of taxonomy (e.g. subfamily, order, superclass). The names of
the arguments will be the column names of the output, and the values of the
arguments correspond to the columns of <code>occdf</code>. The given order of the
arguments is the order in which they are filtered. Therefore, these arguments
must be in ascending order from lowest to highest taxonomic rank (see
examples below). At least one higher level of taxonomy must be specified.</p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p><code>character</code>. The name of the column in <code>occdf</code>
containing the taxonomic names at mixed taxonomic levels; the data column
"accepted_name" in a <a href="https://paleobiodb.org/#/" class="external-link">Paleobiology Database</a>
occurrence dataframe is of this type.</p></dd>


<dt id="arg-resolution">resolution<a class="anchor" aria-label="anchor" href="#arg-resolution"></a></dt>
<dd><p><code>character</code>. The taxonomic resolution at which to
identify unique occurrences, either "species" (the default) or "genus".</p></dd>


<dt id="arg-append">append<a class="anchor" aria-label="anchor" href="#arg-append"></a></dt>
<dd><p><code>logical</code>. Should the original dataframe be returned with
the unique names appended as a new column?</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>dataframe</code> of taxa, with each row corresponding to a unique
"species" or "genus" in the dataset (depending on the chosen resolution).
The dataframe will include the taxonomic information provided into the
function, as well as a column providing the 'unique' names of each taxon. If
<code>append</code> is <code>TRUE</code>, the original dataframe (<code>occdf</code>) will be
returned with these 'unique' names appended as a new column. Occurrences that
are identified to a coarse taxonomic resolution and belong to a clade which
is already represented within the dataset will have their 'unique' names
listed as <code>NA</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Palaeobiologists usually count unique taxa by retaining only
unique occurrences identified to a given taxonomic resolution, however
this function retains occurrences identified to a coarser taxonomic
resolution which are not already represented within the dataset. For example,
consider the following set of occurrences:</p><ul><li><p><em>Albertosaurus sarcophagus</em></p></li>
<li><p><em>Ankylosaurus</em> sp.</p></li>
<li><p>Aves indet.</p></li>
<li><p>Ceratopsidae indet.</p></li>
<li><p>Hadrosauridae indet.</p></li>
<li><p><em>Ornithomimus</em> sp.</p></li>
<li><p><em>Tyrannosaurus rex</em></p></li>
</ul><p>A filter for species-level identifications would reduce the species richness
to two. However, none of these clades are nested within one another, so each
of the indeterminately identified occurrences represents at least one species
not already represented in the dataset. This function is designed to deal
with such taxonomic data, and would retain all seven 'species' in this
example.</p>
<p>Taxonomic information is supplied within a dataframe, in which columns
provide identifications at different taxonomic levels. Occurrence
data can be filtered to retain either unique species, or unique genera. If a
species-level filter is desired, the minimum input requires either (1)
<code>binomial</code>, (2) <code>species</code> and <code>genus</code>, or (3) <code>name</code> and <code>genus</code> columns to
be entered, as well as at least one column of a higher taxonomic level.
In a standard <a href="https://paleobiodb.org/#/" class="external-link">Paleobiology Database</a>
occurrence dataframe, species names are only
captured in the 'accepted_name' column, so a species-level filter should use
'<code>genus</code> = "genus"' and '<code>name</code> = "accepted_name"' arguments. If a
genus-level filter is desired, the minimum input requires either (1)
<code>binomial</code> or (2) <code>genus</code> columns to be entered, as well as at least one
column of a higher taxonomic level.</p>
<p>Missing data should be indicated with NAs, although the function can handle
common labels such as "NO_FAMILY_SPECIFIED" within Paleobiology Database
datasets.</p>
<p>The function matches taxonomic names at face value, so homonyms may be
falsely filtered out.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>



<p>Mannion, P. D., Upchurch, P., Carrano, M. T., and Barrett, P. M. (2011).
Testing the effect of the rock record on diversity: a multidisciplinary
approach to elucidating the generic richness of sauropodomorph dinosaurs
through time.
Biological Reviews, 86, 157-181. <a href="https://doi.org/10.1111/j.1469-185X.2010.00139.x" class="external-link">doi:10.1111/j.1469-185X.2010.00139.x</a>
.</p>
    </div>
    <div class="section level2">
    <h2 id="developer-s-">Developer(s)<a class="anchor" aria-label="anchor" href="#developer-s-"></a></h2>


<p>Bethany Allen &amp; William Gearty</p>
    </div>
    <div class="section level2">
    <h2 id="reviewer-s-">Reviewer(s)<a class="anchor" aria-label="anchor" href="#reviewer-s-"></a></h2>


<p>Lewis A. Jones &amp; William Gearty</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#Retain unique species</span></span></span>
<span class="r-in"><span><span class="va">occdf</span> <span class="op">&lt;-</span> <span class="va">tetrapods</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">species</span> <span class="op">&lt;-</span> <span class="fu">tax_unique</span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">occdf</span>, genus <span class="op">=</span> <span class="st">"genus"</span>, family <span class="op">=</span> <span class="st">"family"</span>,</span></span>
<span class="r-in"><span>order <span class="op">=</span> <span class="st">"order"</span>, class <span class="op">=</span> <span class="st">"class"</span>, name <span class="op">=</span> <span class="st">"accepted_name"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Retain unique genera</span></span></span>
<span class="r-in"><span><span class="va">genera</span> <span class="op">&lt;-</span> <span class="fu">tax_unique</span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">occdf</span>, genus <span class="op">=</span> <span class="st">"genus"</span>, family <span class="op">=</span> <span class="st">"family"</span>,</span></span>
<span class="r-in"><span>order <span class="op">=</span> <span class="st">"order"</span>, class <span class="op">=</span> <span class="st">"class"</span>, resolution <span class="op">=</span> <span class="st">"genus"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Append unique names to the original occurrences</span></span></span>
<span class="r-in"><span><span class="va">genera_append</span> <span class="op">&lt;-</span> <span class="fu">tax_unique</span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">occdf</span>, genus <span class="op">=</span> <span class="st">"genus"</span>, family <span class="op">=</span> <span class="st">"family"</span>,</span></span>
<span class="r-in"><span>order <span class="op">=</span> <span class="st">"order"</span>, class <span class="op">=</span> <span class="st">"class"</span>, resolution <span class="op">=</span> <span class="st">"genus"</span>, append <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Create dataframe from lists</span></span></span>
<span class="r-in"><span><span class="va">occdf2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rex"</span>, <span class="st">"aegyptiacus"</span>, <span class="cn">NA</span><span class="op">)</span>, genus <span class="op">=</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tyrannosaurus"</span>, <span class="st">"Spinosaurus"</span>, <span class="cn">NA</span><span class="op">)</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tyrannosauridae"</span>,</span></span>
<span class="r-in"><span><span class="st">"Spinosauridae"</span>, <span class="st">"Diplodocidae"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dinosaur_species</span> <span class="op">&lt;-</span> <span class="fu">tax_unique</span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">occdf2</span>, species <span class="op">=</span> <span class="st">"species"</span>, genus <span class="op">=</span></span></span>
<span class="r-in"><span><span class="st">"genus"</span>, family <span class="op">=</span> <span class="st">"family"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Retain unique genera per collection with group_apply</span></span></span>
<span class="r-in"><span><span class="va">genera</span> <span class="op">&lt;-</span> <span class="fu"><a href="group_apply.html">group_apply</a></span><span class="op">(</span>occdf <span class="op">=</span> <span class="va">occdf</span>,</span></span>
<span class="r-in"><span>                     group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"collection_no"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     fun <span class="op">=</span> <span class="va">tax_unique</span>,</span></span>
<span class="r-in"><span>                     genus <span class="op">=</span> <span class="st">"genus"</span>,</span></span>
<span class="r-in"><span>                     family <span class="op">=</span> <span class="st">"family"</span>,</span></span>
<span class="r-in"><span>                     order <span class="op">=</span> <span class="st">"order"</span>,</span></span>
<span class="r-in"><span>                     class <span class="op">=</span> <span class="st">"class"</span>,</span></span>
<span class="r-in"><span>                     resolution <span class="op">=</span> <span class="st">"genus"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.lewisajones.com" class="external-link">Lewis A. Jones</a>, <a href="https://williamgearty.com" class="external-link">William Gearty</a>, <a href="https://bsse.ethz.ch/cevo/the-group/people/person-detail.html?persid=295484" class="external-link">Bethany J. Allen</a>, <a href="https://keichenseer.netlify.app" class="external-link">Kilian Eichenseer</a>, <a href="https://www.ucl.ac.uk/earth-sciences/people/research-staff/dr-chris-dean" class="external-link">Christopher D. Dean</a>, <a href="https://www.researchgate.net/profile/Joseph-Flannery-Sutherland" class="external-link">Joseph T. Flannery-Sutherland</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

